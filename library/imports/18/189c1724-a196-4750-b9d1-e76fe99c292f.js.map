{"version":3,"sources":["../../../../../../../assets/cases/03_gameplay/01_player_control/DeviceMotion/assets/cases/03_gameplay/01_player_control/DeviceMotion/DeviceMotionCtrl.js"],"names":["cc","Class","extends","Component","properties","speed","target","Node","_time","_range","p","_acc","onLoad","screenSize","view","getVisibleSize","x","width","y","height","inputManager","setAccelerometerEnabled","systemEvent","on","SystemEvent","EventType","DEVICEMOTION","onDeviceMotionEvent","onDestroy","off","event","acc","update","dt","range","clampf"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,eAAO,GADC;AAERC,gBAAQN,GAAGO,IAFH;AAGRC,eAAO,CAHC;AAIRC,gBAAQT,GAAGU,CAAH,CAAK,CAAL,EAAQ,CAAR,CAJA;AAKRC,cAAMX,GAAGU,CAAH,CAAK,CAAL,EAAQ,CAAR;AALE,KAHP;;AAWLE,UAXK,oBAWK;AACN,YAAIC,aAAab,GAAGc,IAAH,CAAQC,cAAR,EAAjB;AACA,aAAKN,MAAL,CAAYO,CAAZ,GAAgBH,WAAWI,KAAX,GAAmB,CAAnB,GAAuB,KAAKX,MAAL,CAAYW,KAAZ,GAAoB,CAA3D;AACA,aAAKR,MAAL,CAAYS,CAAZ,GAAgBL,WAAWM,MAAX,GAAoB,CAApB,GAAwB,KAAKb,MAAL,CAAYa,MAAZ,GAAqB,CAA7D;AACAnB,WAAGoB,YAAH,CAAgBC,uBAAhB,CAAwC,IAAxC;AACArB,WAAGsB,WAAH,CAAeC,EAAf,CAAkBvB,GAAGwB,WAAH,CAAeC,SAAf,CAAyBC,YAA3C,EAAyD,KAAKC,mBAA9D,EAAmF,IAAnF;AACH,KAjBI;AAmBLC,aAnBK,uBAmBQ;AACT5B,WAAGoB,YAAH,CAAgBC,uBAAhB,CAAwC,KAAxC;AACArB,WAAGsB,WAAH,CAAeO,GAAf,CAAmB7B,GAAGwB,WAAH,CAAeC,SAAf,CAAyBC,YAA5C,EAA0D,KAAKC,mBAA/D,EAAoF,IAApF;AACH,KAtBI;AAwBLA,uBAxBK,+BAwBgBG,KAxBhB,EAwBuB;AACxB,aAAKnB,IAAL,CAAUK,CAAV,GAAec,MAAMC,GAAN,CAAUf,CAAzB;AACA,aAAKL,IAAL,CAAUO,CAAV,GAAeY,MAAMC,GAAN,CAAUb,CAAzB;AACH,KA3BI;AA6BLc,UA7BK,kBA6BGC,EA7BH,EA6BO;AACR,YAAI3B,SAAS,KAAKA,MAAlB;AAAA,YAA0B4B,QAAQ,KAAKzB,MAAvC;AACA,aAAKD,KAAL,IAAc,CAAd;AACAF,eAAOU,CAAP,IAAY,KAAKL,IAAL,CAAUK,CAAV,GAAciB,EAAd,IAAoB,KAAK5B,KAAL,GAAa,KAAKG,KAAtC,CAAZ;AACAF,eAAOU,CAAP,GAAWhB,GAAGmC,MAAH,CAAU7B,OAAOU,CAAjB,EAAoB,CAACkB,MAAMlB,CAA3B,EAA8BkB,MAAMlB,CAApC,CAAX;AACAV,eAAOY,CAAP,IAAY,KAAKP,IAAL,CAAUO,CAAV,GAAce,EAAd,IAAoB,KAAK5B,KAAL,GAAa,KAAKG,KAAtC,CAAZ;AACAF,eAAOY,CAAP,GAAWlB,GAAGmC,MAAH,CAAU7B,OAAOY,CAAjB,EAAoB,CAACgB,MAAMhB,CAA3B,EAA8BgB,MAAMhB,CAApC,CAAX;;AAEA,YAAIZ,OAAOU,CAAP,IAAY,CAACkB,MAAMlB,CAAnB,IAAwBV,OAAOU,CAAP,IAAYkB,MAAMlB,CAA1C,IACAV,OAAOY,CAAP,IAAY,CAACgB,MAAMhB,CADnB,IACwBZ,OAAOY,CAAP,IAAYgB,MAAMhB,CAD9C,EACiD;AAC7C,iBAAKV,KAAL,GAAa,CAAb;AACH;AACJ;AAzCI,CAAT","file":"DeviceMotionCtrl.js","sourceRoot":"../../../../../../../assets/cases/03_gameplay/01_player_control/DeviceMotion","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        speed: 200,\n        target: cc.Node,\n        _time: 0,\n        _range: cc.p(0, 0),\n        _acc: cc.p(0, 0)\n    },\n\n    onLoad () {\n        var screenSize = cc.view.getVisibleSize();\n        this._range.x = screenSize.width / 2 - this.target.width / 2;\n        this._range.y = screenSize.height / 2 - this.target.height / 2;\n        cc.inputManager.setAccelerometerEnabled(true);\n        cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION, this.onDeviceMotionEvent, this);\n    },\n\n    onDestroy () {\n        cc.inputManager.setAccelerometerEnabled(false);\n        cc.systemEvent.off(cc.SystemEvent.EventType.DEVICEMOTION, this.onDeviceMotionEvent, this);\n    },\n\n    onDeviceMotionEvent (event) {\n        this._acc.x =  event.acc.x;\n        this._acc.y =  event.acc.y;\n    },\n\n    update (dt) {\n        var target = this.target, range = this._range;\n        this._time += 5;\n        target.x += this._acc.x * dt * (this.speed + this._time);\n        target.x = cc.clampf(target.x, -range.x, range.x);\n        target.y += this._acc.y * dt * (this.speed + this._time);\n        target.y = cc.clampf(target.y, -range.y, range.y);\n\n        if (target.x <= -range.x || target.x >= range.x ||\n            target.y <= -range.y || target.y >= range.y) {\n            this._time = 0;\n        }\n    }\n\n});\n"]}